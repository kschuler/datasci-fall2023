[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Datasci for lang & mind",
    "section": "",
    "text": "contact: katie, june, avinash, ravi\nresources: ed, canvas, gradescope, colab\n\n\n\n\nWeek\nDay\nTopic\nResources\n\n\n\n\n1\n08-28\nHello, world!\nslides\n\n\n1\n08-31\nR-basics\nslides, demo, lab\n\n\n2\n09-05\nData importing\nslides, demo\n\n\n2\n09-07\nData visualization\nslides, demo, lab\n\n\n2\n09-10\nProblem set 1\nsolutions\n\n\n3\n09-12\nMore data visualization\nsee 09-07, demo\n\n\n3\n09-14\nData wrangling\nslides, lab\n\n\n4\n09-19\nQuiz 1\nstudy guide, solutions\n\n\n4\n09-20\nSampling distribution\nslides, lab\n\n\n5\n09-26\nClass cancelled\n\n\n\n5\n09-28\nHypothesis testing\nslides, demo\n\n\n5\n10-03\nProblem set 2\n\n\n\n6\n10-03\nModel specification\nslides\n\n\n6\n10-05\nQuiz 2 review\npractice quiz\n\n\n7\n10-10\nQuiz 2\nsolutions\n\n\n7\n10-12\nNo class, break\n\n\n\n8\n10-17\nModel fitting\nslides\n\n\n8\n10-19\nModel fitting tutorial\nslides, demo\n\n\n9\n10-24\nModel accuracy\nslides\n\n\n9\n10-26\nModel accuracy tutorial\ndemo solutions\n\n\n9\n10-26\nProblem set 3\n\n\n\n10\n10-31\nQuiz 3 review\npractice quiz 3, slido\n\n\n10\n11-02\nQuiz 3 (thursday!)\n\n\n\n11\n11-07\nModel reliability\n\n\n\n11\n11-09\nModel reliability tutorial\n\n\n\n12\n11-14\nClassification\nreading\n\n\n12\n11-16\nClassification tutorial\n\n\n\n12\n11-20\nProblem set 4\n\n\n\n13\n11-21\nClass cancelled\n\n\n\n13\n11-23\nNo class, break\n\n\n\n14\n11-28\nQuiz 4 review\n\n\n\n14\n11-30\nQuiz 4 (thursday!)\n\n\n\n14\n12-03\nProblem set 5\n\n\n\n15\n12-05\nClass cancelled\n\n\n\n15\n12-07\nInference (and more)\n\n\n\n15\n12-10\nProblem set 6"
  },
  {
    "objectID": "slides/model-specification.html#you-are-here",
    "href": "slides/model-specification.html#you-are-here",
    "title": "Model specification",
    "section": "You are here",
    "text": "You are here\n\n\nData science with R\n\n\nHello, world!\nR basics\nData importing\nData visualization\nData wrangling\n\n\n\nStats & Model buidling\n\n\nSampling distribution\nHypothesis testing\nModel specification\nModel fitting\nModel accuracy\nModel reliability\n\n\n\nMore advanced\n\n\nClassification\nFeature engineering (preprocessing)\nInference for regression\nMixed-effect models"
  },
  {
    "objectID": "slides/model-specification.html#weve-been-modeling",
    "href": "slides/model-specification.html#weve-been-modeling",
    "title": "Model specification",
    "section": "We’ve been modeling!",
    "text": "We’ve been modeling!\n\nThe black dots are our data\ny is the response variable\nx is the explanatory variable"
  },
  {
    "objectID": "slides/model-specification.html#weve-been-modeling-1",
    "href": "slides/model-specification.html#weve-been-modeling-1",
    "title": "Model specification",
    "section": "We’ve been modeling!",
    "text": "We’ve been modeling!\nThe red line is our model (a linear model)"
  },
  {
    "objectID": "slides/model-specification.html#weve-been-modeling-2",
    "href": "slides/model-specification.html#weve-been-modeling-2",
    "title": "Model specification",
    "section": "We’ve been modeling!",
    "text": "We’ve been modeling!\n\nModel specification: \\(y=ax+b\\)\nFit the model: estimate free parameters \\(a\\) and \\(b\\)\nFitted model: \\(y=0.39x+2.02\\)"
  },
  {
    "objectID": "slides/model-specification.html#model-building-overview",
    "href": "slides/model-specification.html#model-building-overview",
    "title": "Model specification",
    "section": "Model building overview",
    "text": "Model building overview\n\nModel specification (this week): what is the form?\nModel fitting (this week); you have the form, how do you guess the free parameters?\nModel accuracy (after break): you’ve estimated the parameters, how well does that model describe your data?\nModel reliability (after break): when you estimate the parameters, there is some uncertainty on them"
  },
  {
    "objectID": "slides/model-specification.html#types-of-models",
    "href": "slides/model-specification.html#types-of-models",
    "title": "Model specification",
    "section": "Types of models",
    "text": "Types of models"
  },
  {
    "objectID": "slides/model-specification.html#supervised-learning",
    "href": "slides/model-specification.html#supervised-learning",
    "title": "Model specification",
    "section": "Supervised learning",
    "text": "Supervised learning\n\n\n\nFigure by Kendrick Kay"
  },
  {
    "objectID": "slides/model-specification.html#regression-v-classification",
    "href": "slides/model-specification.html#regression-v-classification",
    "title": "Model specification",
    "section": "Regression v classification",
    "text": "Regression v classification\n\n\n\nFigure by Kendrick Kay"
  },
  {
    "objectID": "slides/model-specification.html#regression-v-classification-1",
    "href": "slides/model-specification.html#regression-v-classification-1",
    "title": "Model specification",
    "section": "Regression v classification",
    "text": "Regression v classification\n\n\n\nFigure by Kendrick Kay"
  },
  {
    "objectID": "slides/model-specification.html#linear-v-nonlinear",
    "href": "slides/model-specification.html#linear-v-nonlinear",
    "title": "Model specification",
    "section": "Linear v nonlinear",
    "text": "Linear v nonlinear\n\n\n\nFigure by Kendrick Kay"
  },
  {
    "objectID": "slides/model-specification.html#model-building-overview-refresh",
    "href": "slides/model-specification.html#model-building-overview-refresh",
    "title": "Model specification",
    "section": "Model building overview refresh",
    "text": "Model building overview refresh\n\nModel specification (this week): what is the form?\nModel fitting (this week); you have the form, how do you guess the free parameters?\nModel accuracy (after break): you’ve estimated the parameters, how well does that model describe your data?\nModel reliability (after break): when you estimate the parameters, there is some uncertainty on them"
  },
  {
    "objectID": "slides/model-specification.html#model-specification",
    "href": "slides/model-specification.html#model-specification",
    "title": "Model specification",
    "section": "Model specification",
    "text": "Model specification"
  },
  {
    "objectID": "slides/model-specification.html#todays-dataset-swim-records",
    "href": "slides/model-specification.html#todays-dataset-swim-records",
    "title": "Model specification",
    "section": "Today’s dataset: swim records",
    "text": "Today’s dataset: swim records\nHow have world swim records in the 100m changed over the years?\n\nlibrary(mosaic)\nglimpse(SwimRecords)\n\nRows: 62\nColumns: 3\n$ year &lt;int&gt; 1905, 1908, 1910, 1912, 1918, 1920, 1922, 1924, 1934, 1935, 1936,…\n$ time &lt;dbl&gt; 65.80, 65.60, 62.80, 61.60, 61.40, 60.40, 58.60, 57.40, 56.80, 56…\n$ sex  &lt;fct&gt; M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M, M,…"
  },
  {
    "objectID": "slides/model-specification.html#response-variable-y",
    "href": "slides/model-specification.html#response-variable-y",
    "title": "Model specification",
    "section": "Response variable \\(y\\)",
    "text": "Response variable \\(y\\)\nWhat is the thing you are trying to understand?"
  },
  {
    "objectID": "slides/model-specification.html#explanatory-variables-x_n",
    "href": "slides/model-specification.html#explanatory-variables-x_n",
    "title": "Model specification",
    "section": "Explanatory variable(s) \\(x_n\\)",
    "text": "Explanatory variable(s) \\(x_n\\)\nWhat could explain the variation in your response variable?\n\nyearyear + sex"
  },
  {
    "objectID": "slides/model-specification.html#functional-form",
    "href": "slides/model-specification.html#functional-form",
    "title": "Model specification",
    "section": "Functional form",
    "text": "Functional form\n\nModel specification: \\(y=ax+b\\)\nFit the model: estimate free parameters \\(a\\) and \\(b\\)\nFitted model: \\(y=0.39x+2.02\\)"
  },
  {
    "objectID": "slides/model-specification.html#functional-form-1",
    "href": "slides/model-specification.html#functional-form-1",
    "title": "Model specification",
    "section": "Functional form",
    "text": "Functional form\n\nhigh school algebra: \\(y=ax+b\\)\nmachine learning: \\(y = w_0 + w_1x_1 + w_2x_2 + ... + w_nx_n\\)\nstatistics: \\(y = β_0 + β_1x_1 + β_2x_2 + ... + β_nx_n + ε\\)\nmatrix: \\(y = Xβ + ε\\)"
  },
  {
    "objectID": "slides/model-specification.html#model-terms",
    "href": "slides/model-specification.html#model-terms",
    "title": "Model specification",
    "section": "Model terms",
    "text": "Model terms\nModel terms describe how to include our explanatory variables in our model formula — there is more than one way!\n\nIntercept\nMain\nInteraction\nTransformation"
  },
  {
    "objectID": "slides/model-specification.html#intercept",
    "href": "slides/model-specification.html#intercept",
    "title": "Model specification",
    "section": "Intercept",
    "text": "Intercept\n\nin R: y ~ 1\nin eq: \\(y=\\beta_0 + \\varepsilon\\)"
  },
  {
    "objectID": "slides/model-specification.html#main",
    "href": "slides/model-specification.html#main",
    "title": "Model specification",
    "section": "Main",
    "text": "Main\n\nin R: y ~ 1 + year + gender\nin eq: \\(y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2\\)\n\n\nyearsexyear + sex"
  },
  {
    "objectID": "slides/model-specification.html#interaction",
    "href": "slides/model-specification.html#interaction",
    "title": "Model specification",
    "section": "Interaction",
    "text": "Interaction\n\nin R: y ~ 1 + year + gender + year:gender\n\nor the short way: y ~ 1 + year * gender\n\nin eq: \\(y = \\beta_0 + \\beta_1x_1 + \\beta_2x_2 + \\beta_3x_1x_2\\)"
  },
  {
    "objectID": "slides/model-specification.html#transformation",
    "href": "slides/model-specification.html#transformation",
    "title": "Model specification",
    "section": "Transformation",
    "text": "Transformation\n\n\n\n\nhttps://kathrynschuler.com/datasci"
  },
  {
    "objectID": "slides/model-fitting.html#you-are-here",
    "href": "slides/model-fitting.html#you-are-here",
    "title": "Model Fitting",
    "section": "You are here",
    "text": "You are here\n\n\nData science with R\n\n\nHello, world!\nR basics\nData importing\nData visualization\nData wrangling\n\n\n\nStats & Model buidling\n\n\nSampling distribution\nHypothesis testing\nModel specification\nModel fitting\nModel accuracy\nModel reliability\n\n\n\nMore advanced\n\n\nClassification\nFeature engineering (preprocessing)\nInference for regression\nMixed-effect models"
  },
  {
    "objectID": "slides/model-fitting.html#model-building-overview",
    "href": "slides/model-fitting.html#model-building-overview",
    "title": "Model Fitting",
    "section": "Model building overview",
    "text": "Model building overview\n\nModel specification: what is the form?\nModel fitting: you have the form, how do you guess the free parameters?\nModel accuracy: you’ve estimated the parameters, how well does that model describe your data?\nModel reliability: when you estimate the parameters, there is some uncertainty on them"
  },
  {
    "objectID": "slides/model-fitting.html#section",
    "href": "slides/model-fitting.html#section",
    "title": "Model Fitting",
    "section": "",
    "text": "Types of models\n\n\nSpecification\n\nResponse, \\(y\\)\nExplanatory, \\(x_n\\)\nFunctional form, \\(y=\\beta_0 + \\beta_1x_1 + \\epsilon\\)\nModel terms\n\nIntercept\nMain\nInteraction\nTransformation"
  },
  {
    "objectID": "slides/model-fitting.html#linear-model-functional-form",
    "href": "slides/model-fitting.html#linear-model-functional-form",
    "title": "Model Fitting",
    "section": "Linear model functional form",
    "text": "Linear model functional form\n\n\n\nfield\nlinear model eq\n\n\n\n\nh.s. algebra\n\\(y=ax+b\\)\n\n\nmachine learning\n\\(y = w_0 + w_1x_1 + w_2x_2 + ... + w_nx_n\\)\n\n\nstatistics\n\\(y = β_0 + β_1x_1 + β_2x_2 + ... + β_nx_n + ε\\)\n\n\nmatrix\n\\(y = Xβ + ε\\)"
  },
  {
    "objectID": "slides/model-fitting.html#model-fitting-1",
    "href": "slides/model-fitting.html#model-fitting-1",
    "title": "Model Fitting",
    "section": "Model fitting",
    "text": "Model fitting\n\n\n\n\n\nflowchart TD\n    spec(Model specification) --&gt; fit(Estimate free parameters) \n    fit(Estimate free parameters) --&gt; fitted(Fitted model)"
  },
  {
    "objectID": "slides/model-fitting.html#fitting-a-linear-model",
    "href": "slides/model-fitting.html#fitting-a-linear-model",
    "title": "Model Fitting",
    "section": "Fitting a linear model",
    "text": "Fitting a linear model\n\n\n\n\n\n\n\nflowchart TD\n    spec(Model specification \\n y = ax + b) --&gt; fit(Estimate free parameters) \n    fit(Estimate free parameters) --&gt; fitted(Fitted model \\n y = 0.7x + 0.6) \n\n\n\n\n\n\n\n\nggplot(data, aes(x = x, y = y)) +\n    geom_point(size = 4, color = \"darkred\") +\n    geom_smooth(method = \"lm\", formula = 'y ~ x', se = FALSE)"
  },
  {
    "objectID": "slides/model-fitting.html#fitting-by-intuition",
    "href": "slides/model-fitting.html#fitting-by-intuition",
    "title": "Model Fitting",
    "section": "Fitting by intuition",
    "text": "Fitting by intuition\nHow would you draw a “best fit” line?"
  },
  {
    "objectID": "slides/model-fitting.html#fitting-by-intuition-1",
    "href": "slides/model-fitting.html#fitting-by-intuition-1",
    "title": "Model Fitting",
    "section": "Fitting by intuition",
    "text": "Fitting by intuition\nWhich line fits best? How can you tell?"
  },
  {
    "objectID": "slides/model-fitting.html#quantifying-goodness-of-fit",
    "href": "slides/model-fitting.html#quantifying-goodness-of-fit",
    "title": "Model Fitting",
    "section": "Quantifying “goodness” of fit",
    "text": "Quantifying “goodness” of fit\nWe can measure how close the model is to the data\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nresiduals"
  },
  {
    "objectID": "slides/model-fitting.html#ssesum_iin-d_i---m_i2",
    "href": "slides/model-fitting.html#ssesum_iin-d_i---m_i2",
    "title": "Model Fitting",
    "section": "\\(SSE=\\sum_{i=i}^{n} (d_{i} - m_{i})^2\\)",
    "text": "\\(SSE=\\sum_{i=i}^{n} (d_{i} - m_{i})^2\\)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nx\ny\npred\nerr\nsq_err\n\n\n\n\n1\n1.2\n1.3\n-0.1\n0.01\n\n\n2\n2.5\n2.0\n0.5\n0.25\n\n\n3\n2.3\n2.7\n-0.4\n0.16\n\n\n4\n3.1\n3.4\n-0.3\n0.09\n\n\n5\n4.4\n4.1\n0.3\n0.09\n\n\n\n\n\n\n\n\nx\ny\npred\nerr\nsq_err\n\n\n\n\n1\n1.2\n1.58\n-0.38\n0.1444\n\n\n2\n2.5\n2.62\n-0.12\n0.0144\n\n\n3\n2.3\n3.66\n-1.36\n1.8496\n\n\n4\n3.1\n4.70\n-1.60\n2.5600\n\n\n5\n4.4\n5.74\n-1.34\n1.7956"
  },
  {
    "objectID": "slides/model-fitting.html#but-there-are-infinite-possibilities",
    "href": "slides/model-fitting.html#but-there-are-infinite-possibilities",
    "title": "Model Fitting",
    "section": "But there are infinite possibilities",
    "text": "But there are infinite possibilities\nWe can’t test all Inf of the possible free parameters\n\\(y=b_0+b_1x_1\\)\n\n\nFree parameters to test\n\n\nLevel = SSE"
  },
  {
    "objectID": "slides/model-fitting.html#error-surface",
    "href": "slides/model-fitting.html#error-surface",
    "title": "Model Fitting",
    "section": "Error surface",
    "text": "Error surface"
  },
  {
    "objectID": "slides/model-fitting.html#gradient-descent-intuition",
    "href": "slides/model-fitting.html#gradient-descent-intuition",
    "title": "Model Fitting",
    "section": "Gradient descent, intuition",
    "text": "Gradient descent, intuition"
  },
  {
    "objectID": "slides/model-fitting.html#gradient-descent",
    "href": "slides/model-fitting.html#gradient-descent",
    "title": "Model Fitting",
    "section": "Gradient descent",
    "text": "Gradient descent"
  },
  {
    "objectID": "slides/model-fitting.html#gradient-descent-linear-model",
    "href": "slides/model-fitting.html#gradient-descent-linear-model",
    "title": "Model Fitting",
    "section": "Gradient descent linear model",
    "text": "Gradient descent linear model\n\nLinear models are convex functions: one minimum"
  },
  {
    "objectID": "slides/model-fitting.html#ordinary-least-squares",
    "href": "slides/model-fitting.html#ordinary-least-squares",
    "title": "Model Fitting",
    "section": "Ordinary least squares",
    "text": "Ordinary least squares\nLinear models have a solution: we can solve for the values with linear algebra.\n\n\n\\(y = ax + b\\)\n\\(1.2 = a1 + b\\)\n\\(2.5 = a2 + b\\)\n\n\nlm(y ~ 1 + x, data)\n\n\nCall:\nlm(formula = y ~ 1 + x, data = data)\n\nCoefficients:\n(Intercept)            x  \n        0.6          0.7  \n\n\n\ndata %&gt;%\n    specify(y ~ 1 + x) %&gt;%\n    fit()\n\n# A tibble: 2 × 2\n  term      estimate\n  &lt;chr&gt;        &lt;dbl&gt;\n1 intercept    0.600\n2 x            0.7  \n\n\n\nordinary least squares\n\n\n\nhttps://kathrynschuler.com/datasci"
  },
  {
    "objectID": "slides/model-fitting-R.html#you-are-here",
    "href": "slides/model-fitting-R.html#you-are-here",
    "title": "Model Fitting with R (demo)",
    "section": "You are here",
    "text": "You are here\n\n\nData science with R\n\n\nHello, world!\nR basics\nData importing\nData visualization\nData wrangling\n\n\n\nStats & Model buidling\n\n\nSampling distribution\nHypothesis testing\nModel specification\nModel fitting\nModel accuracy\nModel reliability\n\n\n\nMore advanced\n\n\nClassification\nFeature engineering (preprocessing)\nInference for regression\nMixed-effect models"
  },
  {
    "objectID": "slides/model-fitting-R.html#roadmap",
    "href": "slides/model-fitting-R.html#roadmap",
    "title": "Model Fitting with R (demo)",
    "section": "Roadmap",
    "text": "Roadmap\n\nFit a model in R\nGoodness of fit: quantifying our intuition\nHow do we estimate the free parameters?\n\nGradient descent - iterative optimization algorithm\nOrdinary least squares - analytical solution for linear regression\n\nIf time: another full example"
  },
  {
    "objectID": "slides/model-fitting-R.html#fit-a-model",
    "href": "slides/model-fitting-R.html#fit-a-model",
    "title": "Model Fitting with R (demo)",
    "section": "Fit a model",
    "text": "Fit a model\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodel specification\n\n\n\n\nR syntax\nrt ~ 1 + experience\n\n\nR syntax\nrt ~ experience\n\n\nEquation\n\\(y=w_0+w_1x_1\\)\n\n\n\n\n\n\n\n\n\nflowchart TD\n    spec(Model specification) --&gt; fit(Estimate free parameters) \n    fit(Estimate free parameters) --&gt; fitted(Fitted model) \n\n\n\n\n\n\n\\(y = 211.271 + -1.695x\\)"
  },
  {
    "objectID": "slides/model-fitting-R.html#fit-a-model-in-r",
    "href": "slides/model-fitting-R.html#fit-a-model-in-r",
    "title": "Model Fitting with R (demo)",
    "section": "Fit a model in R",
    "text": "Fit a model in R\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmodel specification\n\n\n\n\nR syntax\nrt ~ 1 + experience\n\n\nR syntax\nrt ~ experience\n\n\nEquation\n\\(y=w_0+w_1x_1\\)\n\n\n\n\n\n\nlm(rt ~ experience, data = data)\n\n\nCall:\nlm(formula = rt ~ experience, data = data)\n\nCoefficients:\n(Intercept)   experience  \n    211.271       -1.695  \n\n\n\n\n\ndata %&gt;% \n    specify(rt ~ experience) %&gt;%\n    fit()\n\n# A tibble: 2 × 2\n  term       estimate\n  &lt;chr&gt;         &lt;dbl&gt;\n1 intercept    211.  \n2 experience    -1.69\n\n\n\n\n\nlinear_reg() %&gt;%\n    set_engine(\"lm\") %&gt;%\n    fit(rt ~ experience, data = data)\n\nparsnip model object\n\n\nCall:\nstats::lm(formula = rt ~ experience, data = data)\n\nCoefficients:\n(Intercept)   experience  \n    211.271       -1.695"
  },
  {
    "objectID": "slides/model-fitting-R.html#goodness-of-fit",
    "href": "slides/model-fitting-R.html#goodness-of-fit",
    "title": "Model Fitting with R (demo)",
    "section": "Goodness of fit",
    "text": "Goodness of fit\nQuantifying our intution with sum of squared error\n\n\n\n\n\n\n\n\n\n\n\nexperience\nrt\nprediction\nerror\nsquared_error\n\n\n\n\n49\n124\n128.216\n4.216\n17.774656\n\n\n69\n95\n94.316\n-0.684\n0.467856\n\n\n89\n71\n60.416\n-10.584\n112.021056\n\n\n99\n45\n43.466\n-1.534\n2.353156\n\n\n109\n18\n26.516\n8.516\n72.522256\n\n\n\n\n\n\n\n\n\\(SSE=\\sum_{i=i}^{n} (d_{i} - m_{i})^2 = 205.139\\)"
  },
  {
    "objectID": "slides/model-fitting-R.html#sum-of-squared-error",
    "href": "slides/model-fitting-R.html#sum-of-squared-error",
    "title": "Model Fitting with R (demo)",
    "section": "Sum of squared error",
    "text": "Sum of squared error\nGiven some data:\n\n\n\n\n\nexperience\nrt\nprediction\nerror\nsquared_error\n\n\n\n\n49\n124\n128.216\n4.216\n17.774656\n\n\n69\n95\n94.316\n-0.684\n0.467856\n\n\n89\n71\n60.416\n-10.584\n112.021056\n\n\n99\n45\n43.466\n-1.534\n2.353156\n\n\n109\n18\n26.516\n8.516\n72.522256\n\n\n\n\n\n\n\nCompute the sum of squared error:\n\\(SSE=\\sum_{i=i}^{n} (d_{i} - m_{i})^2 = 205.139\\)\n\n\n  data %&gt;%\n    mutate(prediction = 211.271 + -1.695 * experience) %&gt;%\n    mutate(error = prediction - rt) %&gt;%\n    mutate(squared_error = error^2) %&gt;%\n    with(sum(squared_error))\n\n[1] 205.139"
  },
  {
    "objectID": "slides/model-fitting-R.html#gradient-descent",
    "href": "slides/model-fitting-R.html#gradient-descent",
    "title": "Model Fitting with R (demo)",
    "section": "Gradient descent",
    "text": "Gradient descent\nA search problem: we have a parameter space, a cost function, and our job is to search through the space to find the point that minimizes the cost function."
  },
  {
    "objectID": "slides/model-fitting-R.html#gradient-descent-1",
    "href": "slides/model-fitting-R.html#gradient-descent-1",
    "title": "Model Fitting with R (demo)",
    "section": "Gradient descent",
    "text": "Gradient descent\nDefine our cost function:\n\nSSE &lt;- function(data, par) {\n  data %&gt;%\n    mutate(prediction = par[1] + par[2]* experience) %&gt;%\n    mutate(error = prediction - rt) %&gt;%\n    mutate(squared_error = error^2) %&gt;%\n    with(sum(squared_error))\n}\n\nSSE(data = data, par = c(0, 0))\n\n[1] 31791\n\n\n\nImpliment gradient descent algorithm with optimg\n\noptimg(\n    data = data,  # our data\n    par = c(0,0), # our parameters\n    fn = SSE,     # our cost function\n    method = \"STGD\") # our iterative optimization algorithm \n\n$par\n[1] 211.26155  -1.69473\n\n$value\n[1] 205.138\n\n$counts\n[1] 12\n\n$convergence\n[1] 0"
  },
  {
    "objectID": "slides/model-fitting-R.html#ordinary-least-squares-solution",
    "href": "slides/model-fitting-R.html#ordinary-least-squares-solution",
    "title": "Model Fitting with R (demo)",
    "section": "Ordinary least squares solution",
    "text": "Ordinary least squares solution\n\\(y = w_0 + w_1x_1\\)\n\nWe have a system of equations:\n\n\\(124 = w_01 + w_149\\)\n\\(95 = w_01 + w_169\\)\n…\n\\(18 = w_01 + w_1109\\)\n\n\n\nWe can express them as a matrix: \\(Y = Xw + \\epsilon\\)\n\n\nAnd solve with linear algebra: \\(w = (X^TX)^{-1}X^TY\\)"
  },
  {
    "objectID": "slides/model-fitting-R.html#ordinary-least-squares-solution-in-r",
    "href": "slides/model-fitting-R.html#ordinary-least-squares-solution-in-r",
    "title": "Model Fitting with R (demo)",
    "section": "Ordinary least squares solution in R",
    "text": "Ordinary least squares solution in R\n\n ols_matrix_way &lt;- function(X, Y){\n  solve(t(X) %*% X) %*% t(X) %*% Y\n }\n\n\nWe need to construct X and Y (must be matrices):\n(response_matrix &lt;- data %&gt;% select(rt) %&gt;% as.matrix())\n(explanatory_matrix &lt;- data %&gt;% mutate(int = 1) %&gt;% select(int, experience) %&gt;% as.matrix())\n\n\n\n      rt\n[1,] 124\n[2,]  95\n[3,]  71\n[4,]  45\n[5,]  18\n\n\n     int experience\n[1,]   1         49\n[2,]   1         69\n[3,]   1         89\n[4,]   1         99\n[5,]   1        109\n\n\n\n\n\nThen we can use our function to generate the OLS solution:\n\nols_matrix_way(explanatory_matrix, response_matrix)\n\n                   rt\nint        211.270690\nexperience  -1.694828\n\n\n\nlm(rt ~ experience, data = data)\n\n\nCall:\nlm(formula = rt ~ experience, data = data)\n\nCoefficients:\n(Intercept)   experience  \n    211.271       -1.695  \n\n\n\n\n\n\nhttps://kathrynschuler.com/datasci"
  }
]